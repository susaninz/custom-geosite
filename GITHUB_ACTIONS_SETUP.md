# üöÄ GitHub Actions Setup Guide

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ custom geosite.dat

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –ù–ê–°–¢–†–û–ò–¢–¨

### 1. GitHub Secrets

–û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/susaninz/openwrtrouter/settings/secrets/actions

–î–æ–±–∞–≤—å—Ç–µ **2 —Å–µ–∫—Ä–µ—Ç–∞**:

#### `RAILWAY_WEBHOOK_URL`
```
https://openwrtrouter-production.up.railway.app
```

#### `WEBHOOK_SECRET`
```
9fde3ba2adf1c3d063291a508c9873edc879312363bf709424a7bbc63333573c
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ù–ê–°–¢–†–û–ô–ö–ò

### –®–∞–≥ 1: Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã?

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–±–∞ —Å–µ–∫—Ä–µ—Ç–∞ –≤–∏–¥–Ω—ã –≤:
https://github.com/susaninz/openwrtrouter/settings/secrets/actions

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `RAILWAY_WEBHOOK_URL` ‚úÖ
- `WEBHOOK_SECRET` ‚úÖ

### –®–∞–≥ 2: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ workflow

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/susaninz/openwrtrouter/actions
2. –í—ã–±–µ—Ä–∏—Ç–µ "Build Custom Geosite"
3. –ù–∞–∂–º–∏—Ç–µ "Run workflow"
4. –í—ã–±–µ—Ä–∏—Ç–µ "main" branch
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ "force_build" = true (–¥–ª—è –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏)
6. –ù–∞–∂–º–∏—Ç–µ "Run workflow"

### –®–∞–≥ 3: –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º

Workflow –¥–æ–ª–∂–µ–Ω:
1. ‚úÖ Checkout repository
2. ‚úÖ Check updates (–Ω–∞–π–¥—ë—Ç —á—Ç–æ —Ä–µ–ª–∏–∑–æ–≤ –Ω–µ—Ç)
3. ‚úÖ Setup Go
4. ‚úÖ Clone domain-list-community
5. ‚úÖ Filter categories (–æ—Å—Ç–∞–≤–∏—Ç 9 –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
6. ‚úÖ Build geosite.dat (~2-3 –º–∏–Ω—É—Ç—ã)
7. ‚úÖ Create release v1.0.0
8. ‚úÖ Notify Telegram

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3-4 –º–∏–Ω—É—Ç—ã

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:

1. **GitHub Releases:**
   - https://github.com/susaninz/openwrtrouter/releases
   - –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ä–µ–ª–∏–∑ `v1.0.0-commit-XXXXXXXX`
   - –° —Ñ–∞–π–ª–æ–º `geosite.dat` (~4-5 MB)

2. **Telegram:**
   - –í—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
   ```
   ‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
   
   üì¶ –í–µ—Ä—Å–∏—è: v1.0.0
   üíæ –†–∞–∑–º–µ—Ä: 4.2M
   üîπ Commit: 640d414b
   
   üîó –°–∫–∞—á–∞—Ç—å —Ä–µ–ª–∏–∑
   
   üîÑ –†–æ—É—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ
   ```

3. **GitHub Actions:**
   - –ó–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ ‚úÖ —Ä—è–¥–æ–º —Å workflow
   - –í Summary –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–±–æ—Ä–∫–µ

---

## üîÑ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–ü–£–°–ö–ò

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏, workflow –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è:

### 1. –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC)
```yaml
schedule:
  - cron: '0 3 * * *'
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è domain-list-community
- –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤—ã–π geosite.dat
- –ï—Å–ª–∏ –Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–±–æ—Ä–∫—É

### 2. –í—Ä—É—á–Ω—É—é (–∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ)
- GitHub Actions ‚Üí Build Custom Geosite ‚Üí Run workflow
- –ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å "force_build" –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏

### 3. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ workflow —Ñ–∞–π–ª–∞
- –ü—Ä–∏ push `.github/workflows/build-geosite.yml`
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:

#### GitHub Actions
https://github.com/susaninz/openwrtrouter/actions

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ò—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –∑–∞–ø—É—Å–∫–æ–≤
- –õ–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –£—Å–ø–µ—Ö/–æ—à–∏–±–∫–∏

#### GitHub Releases
https://github.com/susaninz/openwrtrouter/releases

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –í—Å–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
- Release notes
- –°—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

#### Telegram Bot
@openwrtrouterbot

–ü–æ–ª—É—á–∞–µ—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- ‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- ‚ùå –°–±–æ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å
- üîî –ù–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ

---

## üêõ TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: Workflow –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã?
2. Workflow —Ñ–∞–π–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ?
3. GitHub Actions –≤–∫–ª—é—á–µ–Ω—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è?

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la .github/workflows/build-geosite.yml

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ syntax YAML
yamllint .github/workflows/build-geosite.yml
```

### –ü—Ä–æ–±–ª–µ–º–∞: Build fails –Ω–∞ —à–∞–≥–µ "Build geosite.dat"

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ Go –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ workflow
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Go 1.21 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ secrets –∏–ª–∏ Railway –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. `RAILWAY_WEBHOOK_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?
2. `WEBHOOK_SECRET` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å .env?
3. Railway –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

**–¢–µ—Å—Ç:**
```bash
curl -X POST https://openwrtrouter-production.up.railway.app/webhook/build-complete \
  -H "Authorization: Bearer YOUR_SECRET" \
  -H "Content-Type: application/json" \
  -d '{"status":"success","version":"test","commit":"test","size":"4M"}'
```

### –ü—Ä–æ–±–ª–µ–º–∞: Release –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ releases

**–†–µ—à–µ–Ω–∏–µ:**
GitHub Actions —É–∂–µ –∏–º–µ–µ—Ç —Ç–æ–∫–µ–Ω `GITHUB_TOKEN` —Å –ø—Ä–∞–≤–∞–º–∏.
–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
Settings ‚Üí Actions ‚Üí General ‚Üí Workflow permissions ‚Üí "Read and write permissions"

---

## üí° –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 workflows
```bash
gh run list --limit 5
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ run
```bash
gh run view --log
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å workflow –≤—Ä—É—á–Ω—É—é
```bash
gh workflow run "Build Custom Geosite" --field force_build=true
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ releases
```bash
gh release list
```

---

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞:
```
Version: v1.0.0-commit-640d414b
Size: 4.2M (–±—ã–ª–æ 85M)
Categories: 9 (–±—ã–ª–æ ~1000)
Time: ~3 –º–∏–Ω—É—Ç—ã
Cost: 3 –º–∏–Ω—É—Ç—ã –∏–∑ 2000
```

### –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–±–æ—Ä–∫–∏:
```
Frequency: ~1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (–∫–æ–≥–¥–∞ domain-list –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
Monthly cost: 12-16 –º–∏–Ω—É—Ç –∏–∑ 2000
Automatic: –î–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é
Notifications: Telegram
```

---

## ‚úÖ CHECKLIST –ù–ê–°–¢–†–û–ô–ö–ò

- [ ] GitHub Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã (RAILWAY_WEBHOOK_URL, WEBHOOK_SECRET)
- [ ] Workflow —Ñ–∞–π–ª –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ `.github/workflows/`
- [ ] Railway –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å webhooks
- [ ] –ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –†–µ–ª–∏–∑ v1.0.0 —Å–æ–∑–¥–∞–Ω
- [ ] Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ
- [ ] geosite.dat —Å–∫–∞—á–∞–Ω –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

‚úÖ GitHub Actions –Ω–∞—Å—Ç—Ä–æ–µ–Ω  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏—Ö–æ–¥—è—Ç  
‚úÖ –†–µ–ª–∏–∑—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ –†–æ—É—Ç–µ—Ä –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ!** üöÄ

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OpenClash –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏–∑ GitHub Releases

